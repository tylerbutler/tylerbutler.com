---
/**
 * Component to include Littlefoot.js for interactive footnotes
 * This should be included in pages that contain footnotes
 *
 * Uses external script to avoid Astro's is:inline limitations
 */

// Import Littlefoot CSS - Astro will process and bundle it
import 'littlefoot/dist/littlefoot.css';
---

<!-- Custom footnote styles -->
<style>
  /* Littlefoot.js customizations */
  .littlefoot-footnote__wrapper {
    max-width: 400px;
    z-index: 1000;
  }

  .littlefoot-footnote__content {
    font-size: 0.9em;
    line-height: 1.4;
    color: #333;
  }

  /* Dark mode support - override littlefoot CSS variables on root elements */
  :root.dark {
    /* Button styling for dark mode */
    --button-background-color: var(--code-bg);
    --button-text-color: var(--text);
    --button-active-background-color: var(--accent);
    --button-active-text-color: var(--dark-bg);

    /* Popover styling for dark mode */
    --popover-background-color: var(--code-bg);
    --popover-text-color: var(--text);
    --popover-border: 1px solid var(--code-border);
    --popover-shadow: 0 0 16px rgba(0, 0, 0, 0.8);
    --popover-scroll-indicator-color: var(--accent);
  }

  .dark .littlefoot__content {
    color: var(--text);
  }

  .dark .littlefoot__wrapper {
    background-color: var(--code-bg);
    border-color: var(--code-border);
  }

  .dark .littlefoot__tooltip {
    background-color: var(--code-bg);
    border-color: var(--code-border);
  }

  /* Style footnote references */
  a[rel="footnote"] {
    text-decoration: none;
    color: #0066cc;
    font-weight: 500;
    padding: 0.1em 0.3em;
    border-radius: 3px;
    font-size: 0.85em;
    line-height: 1;
    vertical-align: baseline;
    position: relative;
    top: -0.4em;
  }

  a[rel="footnote"]:hover {
    background-color: #f0f8ff;
    text-decoration: none;
  }

  .dark a[rel="footnote"] {
    color: #66b3ff;
  }

  .dark a[rel="footnote"]:hover {
    background-color: #1a3040;
  }

  /* Hide the footnote section when Littlefoot is active */
  .footnotes-section {
    border-top: 1px solid #e1e1e1;
    margin-top: 2rem;
    padding-top: 1rem;
  }

  .dark .footnotes-section {
    border-top-color: #444;
  }

  /* Hide footnotes section if JavaScript is enabled and Littlefoot loads */
  .littlefoot-footnote__wrapper + .footnotes-section,
  body.littlefoot-active .footnotes-section {
    display: none;
  }
</style>

<!--
  Littlefoot.js initialization script
  Using external script with only 'src' attribute to avoid is:inline behavior
  This allows Astro to properly bundle and optimize the import
-->
<script src="../scripts/littlefoot-init.ts"></script>

<!-- Fallback: show regular footnotes if JavaScript is disabled -->
<noscript>
  <style>
    .footnotes-section {
      display: block !important;
    }
  </style>
</noscript>